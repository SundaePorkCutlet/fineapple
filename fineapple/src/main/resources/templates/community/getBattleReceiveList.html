<!doctype html>
<html xmlns:th="http://www.thymeleaf.org" xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout" lang="ko">
<meta charset="utf-8">
<!-- 공통 header -->
<th:block th:replace="layout/fragments/header.html :: header"></th:block>
<style>
    #swal2-html-container{
        overflow-x: hidden;
    }
    .text-left{
        text-align: left;
    }
</style>
<!--begin::Body-->
<body id="kt_body" class="aside-enabled">
<!-- 공통 SideBar -->
<th:block th:replace="layout/fragments/sidebar.html :: sidebar"></th:block>
<!-- ////////////////////////////////////여기까지 절대 고정 건드리지마셈//////////////////////////////////// -->
<!-- 얘들아 여기서부터 내가 넣고 싶은 바디 내용을 넣는거야!!!! 헤드는 건드릴거 없음 XXXXXXX -->

<div class="tab-content">
    <!--begin::Tab panel-->
    <div id="kt_billing_months" class="card-body p-0 tab-pane fade show active" role="tabpanel" aria-labelledby="kt_billing_months">
        <!--begin::Table container-->
        <div class="table-responsive">
            <!--begin::Table-->

     <!--      
            <a href="#" class="btn btn-sm btn-light" th:onClick="javascript:fcAddGroupView()">
                
                <span class="svg-icon svg-icon-3">
								<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none">
									<rect opacity="0.5" x="11.364" y="20.364" width="16" height="2" rx="1" transform="rotate(-90 11.364 20.364)" fill="black"></rect>
									<rect x="4.36396" y="11.364" width="16" height="2" rx="1" fill="black"></rect>
								</svg>
							</span>
               승부생성</a>
           -->


            <!--begin::Follow-->
            <a th:href="@{/community/getBattleList}" class="btn btn-sm btn-light">
                <!--begin::Svg Icon | path: icons/duotune/arrows/arr075.svg-->
                <span class="svg-icon svg-icon-3">
								<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none">
									<rect opacity="0.5" x="11.364" y="20.364" width="16" height="2" rx="1" transform="rotate(-90 11.364 20.364)" fill="black"></rect>
									<rect x="4.36396" y="11.364" width="16" height="2" rx="1" fill="black"></rect>
								</svg>
							</span>
                <!--end::Svg Icon-->승부 기록</a>
            <!--end::Follow-->


            <!--begin::Follow-->
            <a th:href="@{/community/getBattleRequestList}" class="btn btn-sm btn-light">
                <!--begin::Svg Icon | path: icons/duotune/arrows/arr075.svg-->
                <span class="svg-icon svg-icon-3">
								<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none">
									<rect opacity="0.5" x="11.364" y="20.364" width="16" height="2" rx="1" transform="rotate(-90 11.364 20.364)" fill="black"></rect>
									<rect x="4.36396" y="11.364" width="16" height="2" rx="1" fill="black"></rect>
								</svg>
							</span>
                <!--end::Svg Icon-->승부 보낸 리스트</a>
            <!--end::Follow-->


            <!--begin::Follow-->
            <a th:href="@{/community/getBattleReceiveList}" class="btn btn-sm btn-light">
                <!--begin::Svg Icon | path: icons/duotune/arrows/arr075.svg-->
                <span class="svg-icon svg-icon-3">
								<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none">
									<rect opacity="0.5" x="11.364" y="20.364" width="16" height="2" rx="1" transform="rotate(-90 11.364 20.364)" fill="black"></rect>
									<rect x="4.36396" y="11.364" width="16" height="2" rx="1" fill="black"></rect>
								</svg>
							</span>
                <!--end::Svg Icon-->승부 받은 리스트</a>
            <!--end::Follow-->
        </div>
    </div>
</div>

<div class="content d-flex flex-column flex-column-fluid" id="kt_content">
    <!--begin::Container-->
    <div id="kt_content_container" class="container-fluid">
        <div class="d-flex flex-wrap flex-stack mb-6 mt-4">
            <h3 class="fw-bolder my-2">승부 받은 리스트<span class="fs-6 text-gray-400 fw-bold ms-1"></span></h3>
        </div>
<div th:each = "data : ${list}">
        <div class="row g-6 mb-6 g-xl-9 mb-xl-9" >
      
            <div class="col-md-6 col-xxl-4">
             
                <div class="card">
                	
                    <div class="card-body d-flex flex-center flex-column p-9">
                        <div class="symbol symbol-65px symbol-circle mb-5">
                            <img src="/assets/profile/aaa.jpg"/>
                        </div>
                        <a href="#" class="fs-4 text-gray-800 text-hover-primary fw-bolder mb-0"></a>
                        <div class="fw-bold text-gray-400 mb-6"th:text = "${data.user.userId}"></div>
                        <div class="d-flex flex-center flex-wrap mb-5">
                            <div class="border border-dashed rounded min-w-125px py-3 px-4 mx-3 mb-3">
                                <div class="fs-6 fw-bolder text-gray-700">칼로리 소모</div>
                                <div class="fw-bold text-gray-400">승부 유형</div>
                            </div>
                            <div class="border border-dashed rounded min-w-125px py-3 px-4 mx-3 mb-3">
                                <div class="fs-6 fw-bolder text-gray-700"><span class="comma-3"th:text = "${data.battlePeriod}"></span>일</div>
                                <div class="fw-bold text-gray-400">승부 기간</div>
                            </div>
                            <div class="border border-dashed rounded min-w-125px py-3 px-4 mx-3 mb-3">
                                <div class="fs-6 fw-bolder text-gray-700"><span class="comma-3"th:text = "${data.userTrgtKcal}"></span>Kcal</div>
                                <div class="fw-bold text-gray-400">상대 목표 칼로리</div>
                            </div>
                        </div>
                        <div class="d-flex flex-center flex-wrap mb-5">
                            <a href="#" class="btn btn-sm btn-light-primary mx-3 btn-accept" th:onClick="|javascript:fnDelReceviedBattleAccept(${data.battleNo})|">
                                    <span class="svg-icon svg-icon-3">
												<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none">
													<path opacity="0.3" d="M10 18C9.7 18 9.5 17.9 9.3 17.7L2.3 10.7C1.9 10.3 1.9 9.7 2.3 9.3C2.7 8.9 3.29999 8.9 3.69999 9.3L10.7 16.3C11.1 16.7 11.1 17.3 10.7 17.7C10.5 17.9 10.3 18 10 18Z" fill="black"/>
													<path d="M10 18C9.7 18 9.5 17.9 9.3 17.7C8.9 17.3 8.9 16.7 9.3 16.3L20.3 5.3C20.7 4.9 21.3 4.9 21.7 5.3C22.1 5.7 22.1 6.30002 21.7 6.70002L10.7 17.7C10.5 17.9 10.3 18 10 18Z" fill="black"/>
												</svg>
											</span>
                                <!--end::Svg Icon-->수락</a>
                            <a href="#" class="btn btn-sm btn-light mx-3 btn-reject" th:onClick="|javascript:fnDelReceviedBattleReject(${data.battleNo})|">
                                <!--begin::Svg Icon | path: icons/duotune/arrows/arr075.svg-->
                                <span class="svg-icon svg-icon-3">
                                        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none">
                                            <rect opacity="0.5" x="6" y="17.3137" width="16" height="2" rx="1" transform="rotate(-45 6 17.3137)" fill="black"/>
                                            <rect x="7.41422" y="6" width="16" height="2" rx="1" transform="rotate(45 7.41422 6)" fill="black"/>
                                        </svg>
                                    </span>
                                <!--end::Svg Icon-->거절</a>
                        </div>
   
                </div>
            </div>
            </div>
        </div>
       </div>
        <!--        <div class="d-flex flex-center">-->
        <!--            <button class="btn btn-primary" id="kt_followers_show_more_button">-->
        <!--                <span class="indicator-label">더 보기</span>-->
        <!--                <span class="indicator-progress">...-->
        <!--									<span class="spinner-border spinner-border-sm align-middle ms-2"></span></span>-->
        <!--            </button>-->
        <!--        </div>-->
    </div>
</div>

<!-- ////////////////////////////////////여기부터 다시 절대 고정 건드리지마셈//////////////////////////////////// -->
<!-- 공통 하단 footer -->
<th:block th:replace="layout/fragments/footer.html :: footer"></th:block>
<!-- ////////////////////////////////////여기까지 다시 절대 고정 건드리지마셈//////////////////////////////////// -->
<div id="mmodalHolder"></div>
<!-- 얘들아 여기서부터 너네가 넣고 싶은 자바스크립트 코드 넣으면돼!!!!!! -->

<script>

  /*   $(document).ready(function () {
        addComma();

        $(".btn-accept").click(function (e) {
            e.preventDefault();

            // Swal.fire({
            //     title: '목표 칼로리를 입력해주세요.',
            //     input: 'text',
            //     inputAttributes: {
            //         autocapitalize: 'off'
            //     },
            //     showCancelButton: true,
            //     confirmButtonText: 'Look up',
            //     showLoaderOnConfirm: true,
            //     preConfirm: (login) => {
            //         return fetch(`//api.github.com/users/${login}`)
            //             .then(response => {
            //                 if (!response.ok) {
            //                     throw new Error(response.statusText)
            //                 }
            //                 return response.json()
            //             })
            //             .catch(error => {
            //                 Swal.showValidationMessage(
            //                     `Request failed: ${error}`
            //                 )
            //             })
            //     },
            //     allowOutsideClick: () => !Swal.isLoading()
            // }).then((result) => {
            //     if (result.isConfirmed) {
            //         Swal.fire({
            //             title: `${result.value.login}'s avatar`,
            //             imageUrl: result.value.avatar_url
            //         })
            //     }
            // })


            let swalWithBootstrapButtons = Swal.mixin({
                confirmButtonText:"닫기",
                customClass: {
                    confirmButton: 'btn btn-success',
                    cancelButton: 'btn btn-danger'
                },
                buttonsStyling: false
            })

            let html_ = '';
            html_ += '승부를 수락하시겠습니까?';
            html_ += '<div class="row mb-5 mt-5 pt-5">';
            html_ += '<div class="col-md-12 fv-row text-left">';
            html_ += '<label class="required fs-6 fw-bold mb-2">나의 목표 칼로리</label>';
            html_ += '<input type="text" class="form-control form-control-solid" placeholder="" name="kcal" id="kcal" inputmode="text">';
            html_ += '</div>';
            html_ += '</div>';
            Swal.fire({
                html: html_,
                icon: "question",
                buttonsStyling: false,
                showCancelButton: true,
                confirmButtonText: "수락",
                cancelButtonText: "닫기",
                customClass: {
                    confirmButton: "btn btn-primary",
                    cancelButton: 'btn btn-danger'
                }
            }).then((result) => {
                if (result.isConfirmed) {
                    // 예 클릭
                    console.log($("#kcal").val());

                    // 서버에 수락 요청

                    swalWithBootstrapButtons.fire(
                        '수락되었습니다',
                        '',
                        'success'
                    )
                } else if (result.dismiss === Swal.DismissReason.cancel) {
                    // 아니오 클릭
                    console.log("취소클릭");
                }
            })
        })

        $(".btn-reject").click(function (e) {
            e.preventDefault();

            let swalWithBootstrapButtons = Swal.mixin({
                confirmButtonText:"닫기",
                customClass: {
                    confirmButton: 'btn btn-success',
                    cancelButton: 'btn btn-danger'
                },
                buttonsStyling: false
            })

            Swal.fire({
                html: "승부 신청을 거절하시겠습니까?",
                icon: "warning",
                buttonsStyling: false,
                showCancelButton: true,
                confirmButtonText: "예",
                cancelButtonText: "아니오",
                customClass: {
                    confirmButton: "btn btn-primary",
                    cancelButton: 'btn btn-danger'
                }
            }).then((result) => {
                if (result.isConfirmed) {
                    // 예 클릭
                    swalWithBootstrapButtons.fire(
                        '거절되었습니다',
                        '',
                        'success'
                    )
                } else if (result.dismiss === Swal.DismissReason.cancel) {
                    // 아니오 클릭
                    console.log("취소클릭");
                }
            })
        })
    });

    function addComma() {
        if ($(".comma-3").length > 0) {
            $(".comma-3").each(function () {
                let number_ = $(this).text();
                $(this).text(number_.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ","));
            });
        }
    }

    function cancelBattle() {
        if (confirm("취소하시겠습니까?")) {
            console.log("취소");
        } else {
            console.log("그냥닫기");
        }
    } */
    
    

    function fnDelReceviedBattleAccept(no){ //수락
    	
    	
    	var data = {"battleNo":no};
    	
    	$.ajax({
    		url: "/community/delReceviedBattleAccept", //url : 요청 Url
    		type: "POST", //type : 데이터를 전송하는 방법 (get, post)
    		dataType: "html", //서버측에서 전송받은 데이터의 형식 (default : xml, json, script, text, html) //=> default는 html
    		data: JSON.stringify(data), //요청과 함께 서버로 데이터를 전송 할 string 또는 map
    		contentType: "application/json",  // 서버에 보내는 데이터의 타입이다.
    		//async: false, //async: true <== default
    		success: function(data){ //  요청이 성공 했을 때 호출할 콜백 함수
    			console.log("성공" + data);
    			
    			$("#mmodalHolder").html(data);
                $("#battleReceivedModal").modal("show");
    			
    		}
    		
    	});
    }
    
    
	function fnDelReceviedBattleReject(no){ // 거절
    	
    	
    	var data = {"battleNo":no};
    	
    	$.ajax({
    		url: "/community/json/delReceviedBattleReject", //url : 요청 Url
    		type: "POST", //type : 데이터를 전송하는 방법 (get, post)
    		dataType: "json", //서버측에서 전송받은 데이터의 형식 (default : xml, json, script, text, html) //=> default는 html
    		data: JSON.stringify(data), //요청과 함께 서버로 데이터를 전송 할 string 또는 map
    		contentType: "application/json",  // 서버에 보내는 데이터의 타입이다.
    		//async: false, //async: true <== default
    		success: function(data){ //  요청이 성공 했을 때 호출할 콜백 함수
    			console.log("성공" + data);
    			window.location.reload();
    			
    			
    		}
    		
    	});
    };
</script>

<!-- ////////////////////////////////////여기부터 다시 절대 고정 건드리지마셈//////////////////////////////////// -->
</body>
<!--end::Body-->
</html>